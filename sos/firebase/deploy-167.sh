#!/bin/bash
cd /c/Users/willi/Documents/Projets/VS_CODE/sos-expat-project/sos/firebase
LOG="/c/Users/willi/Documents/Projets/VS_CODE/sos-expat-project/sos/firebase/deploy-167.log"
> "$LOG"
FUNCS=(addBankAccount adminApproveWithdrawal adminBulkInfluencerAction adminCreateMessageTemplate adminCreatePost adminCreateResource adminCreateTrainingModule adminCreateZoomMeeting adminDeleteBloggerGuideBestPractice adminDeleteBloggerGuideCopyText adminDeleteBloggerGuideTemplate adminDeleteBloggerResourceFile adminDeleteBloggerResourceText adminDeleteMessageTemplate adminDeletePost adminDeleteResource adminDeleteTrainingModule adminExportInfluencers adminExportWithdrawals adminGetAuditLogActions adminGetAuditLogs adminGetBloggerGuide adminGetBloggerResources adminGetMeetingAttendees adminGetPaymentConfig adminGetPaymentStats adminGetPendingWithdrawals adminGetPostsList adminGetRateHistory adminGetResourcesList adminGetTrainingModules adminGetWithdrawalsList adminGetZoomMeetings adminProcessWithdrawal adminRejectWithdrawal adminReorderTrainingModules adminResetMessageTemplatesToDefaults adminSaveBloggerGuideBestPractice adminSaveBloggerGuideCopyText adminSaveBloggerGuideTemplate adminSaveBloggerResourceFile adminSaveBloggerResourceText adminSeedInfluencerTrainingModules adminSeedMessageTemplates adminSeedTrainingModules adminToggleFlashBonus adminUpdateAntiFraudConfig adminUpdateChatterConfigSettings adminUpdateCommissionRules adminUpdateMessageTemplate adminUpdatePaymentConfig adminUpdatePost adminUpdateResource adminUpdateTrainingModule adminUpdateZoomMeeting affiliateOnCallCompleted affiliateOnUserCreated aggregateCostMetrics bloggerOnCallSessionCompleted bloggerReleaseValidatedCommissions bloggerValidatePendingCommissions bulkUnblockProviders bulkUnhideProviders bulkUnsuspendProviders cancelWithdrawal capturePayPalOrder chatterAggregateActivityFeed chatterCreateWeeklyChallenge chatterEndWeeklyChallenge chatterMonthlyTop3Rewards chatterNotifyCommissionEarned chatterNotifyFlashBonusStart chatterNotifyInactiveMembers chatterNotifyNearTop3 chatterNotifyTeamMemberActivated chatterNotifyTierBonusUnlocked chatterOnCallCompleted chatterOnClientRegistered chatterOnProviderRegistered chatterOnQuizPassed chatterRegisterFcmToken chatterReleaseValidatedCommissions chatterTierBonusCheck chatterUnregisterFcmToken chatterUpdateChallengeLeaderboard chatterValidatePendingCommissions checkHelpCategories checkPayPalMerchantStatus cleanupExpiredDocuments cleanupFunctionalData clearHelpArticles createCustomAccount createPayPalOnboardingLink createPayPalOrder deletePaymentMethod generateSystemDebugReport getAvailableCountriesForChatter getBloggerRecruits getChallengeHistory getChatterMessageTemplates getCloudTasksQueueStats getCurrentChallenge getMyZoomAttendances getPaymentMethods getQuizQuestions getSystemHealthStatus getUltraDebugLogs getWithdrawalHistory getWithdrawalStatus getZoomMeetings handleAccountStatus handleKYCVerification handlePayPalConfiguration handleProfileCompleted handleProviderOnlineStatus handleUserLogin handleUserRegistration influencerOnCallCompleted influencerOnProviderRegistered influencerReleaseValidatedCommissions influencerValidatePendingCommissions initCountryConfigs initHelpArticlesBatch initKYCReminderTemplates initPayPalWelcomeTemplates initSingleHelpArticle initUnclaimedFundsTemplates initializeAffiliateConfig initializeChatterConfig initializeChatterSystem initializeMessageTemplates initializeProviderTranslation initializeThresholdTracking manuallyTriggerCallExecution markCountryAsRegistered migrateProviderSlugs migrateProvidersToUid onCallCompletedGroupAdmin onUserAccessUpdated onUserCreatedSyncClaims onUserCreatedTrackGoogleAdsSignUp onUserCreatedTrackRegistration onUserEmailUpdated onUserUpdatedSyncClaims recordZoomAttendance releaseValidatedGroupAdminCommissions resetBillingCycleQuotas runCriticalFunctionalCheck runFunctionalHealthCheck savePaymentMethod scheduledBackup seedCountryConfigsHttp setDefaultPaymentMethod submitKycData submitQuiz telegramOnUserRegistration testCAPIConnection testCloudTasksConnection testWebhook translateProvider twilioRecordingWebhook updatePlanPricing updatePlanPricingV2 updateProviderTranslation updateTrialConfig updateTrialConfigV2 validatePendingGroupAdminCommissions)
BATCH_SIZE=5
TOTAL=${#FUNCS[@]}
for (( i=0; i<TOTAL; i+=BATCH_SIZE )); do
  BATCH=("${FUNCS[@]:$i:$BATCH_SIZE}")
  SPEC=$(printf "functions:%s," "${BATCH[@]}" | sed 's/,$//')
  LOT=$(( i/BATCH_SIZE + 1 ))
  echo "[$(date '+%H:%M:%S')] LOT $LOT : ${BATCH[*]}" | tee -a "$LOG"
  firebase deploy --only "$SPEC" --project sos-urgently-ac307 --force 2>&1 | tee -a "$LOG"
  echo "[EXIT: $?]" | tee -a "$LOG"
  sleep 90
done
echo "[$(date '+%H:%M:%S')] TERMINE" | tee -a "$LOG"
